version: 1.0

bookmarks:
  git:
    - https://mikefarah.gitbook.io/yq/usage/convert
    - https://google.com
  jira:
    - https://github.com/ankitpokhrel/jira-cli?tab=readme-ov-file#usage
commands:
  fish:
    - cmd:
      - bind -a | fzf --no-preview
      help: " # list all the keyboard binding for fish shell"
    - cmd:
      - j
      help: " # Jump to a url via goto"
  git:
    - cmd:
      - git checkout {BRANCH}
      help: " # checkout a given branch"
    - cmd:
      - git branch -a
      help: " # List all the git branch"
  tr:
    - cmd:
      - tr -d '\n' < yourfile.txt
      help: " # Delete \\n from a given file."
  task:
    - cmd:
      - task
      help: " # List all the task"
    - cmd:
      - task add {TASK}
      help: " # Add a task"
    - cmd:
      - task {TASK_ID} export | jq .
      help: " # Export a task as json"
    - cmd:
      - task {TASK_ID} export | jq .[].annotations[].description
      help: " # Get the annotations of a task"
  column:
    - cmd:
      - column -s, -t < yourfile.csv
      help: " # Format the output as a table"
  gh:
    - cmd:
      - gh repo view
      help: " # List all the repo"
    - cmd:
      - gh repo clone {REPO}
      help: " # Clone a repo"
    - cmd:
      - gh copilot suggest "install git"
      help: " # Get suggestion from github copilot"
    - help: Find all the PR which were old and open. Close those PRs and delete that branch
      ref: https://git.dev.box.net/gist/vaibhavgupta/85769407f7a39f165244eb85f026089d
      cmd:
        - FILENAME=/tmp/pr.json
        - gh pr list --search "state:open sort:created-asc created:<2022-04-01" --json "id,title,number,headRefName,createdAt" > $FILENAME
        - for i in (cat $FILENAME | jq  -r .[].number); gh pr close  "$i" ; end
        - for i in (cat $FILENAME | jq  -r .[].headRefName); git push origin :$i ; end

  jenkins:
    - cmd:
      - curl --user $JENKINS_USER:$JENKINS_TOKEN -X POST $JENKINS_URL/job/$JENKINS_JOB/build
      help: " # Trigger a jenkins job"
    - cmd:
      - curl --user $JENKINS_USER:$JENKINS_TOKEN $JENKINS_URL/job/$JENKINS_JOB/lastBuild/api/json
      help: " # Get the last build status"
    - cmd:
      - curl --user $JENKINS_USER:$JENKINS_TOKEN $JENKINS_URL/job/$JENKINS_JOB/lastBuild/consoleText
      help: " # Get the last build log"

  gradlew:
    - cmd:
      - ./gradlew test --tests {TEST_NAME}
      help: " # Run a specific test"

  vim:
    - cmd:
      - gx
      help: " # Open the url under the cursor"
    - cmd:
      - :%s/foo/bar/g
      help: " # Replace foo with bar in the whole file"

  box-kubectl:
    - cmd:
      - "for i in `seq 1 3`; do kubectl get pods -n jenkins-agents-dev -o=json --cluster=apps-us-west1-dev-0$i | jq -c '.items[] | {name: .metadata.name, namespace: .metadata.namespace, claimName: .spec | select(has(\"volumes\")).volumes[] | select(has(\"persistentVolumeClaim\")).persistentVolumeClaim.claimName} | select(.claimName != null)'; done"
      help: " # Get the pvc name of all the pods in a namespace"
    - cmd:
      - "for i in `seq 1 3`; do kubectl get pvc -n jenkins-agents-dev --cluster=apps-us-west1-dev-0$i ; done"
      help: " # Get the pvc details of all the pvc in a namespace"



